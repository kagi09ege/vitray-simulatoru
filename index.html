<!DOCTYPE html>
<html>
<head>
    <title>Vitray Işık Simülasyonu</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <style>
        body { font-family: Arial; text-align: center; margin-top: 20px; }
        button { 
            padding: 12px 24px;
            font-size: 18px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        #output { margin: 20px; min-height: 300px; border: 1px dashed #ccc; padding: 10px; }
        #plot { max-width: 100%; }
    </style>
</head>
<body>
    <h1>🎨 Vitray Işık Simülasyonu</h1>
    <button onclick="runSimulation()">SIMÜLASYONU BAŞLAT</button>
    <div id="output">
        <p>Sonuçlar burada görünecek...</p>
        <img id="plot" style="display:none;">
    </div>

    <script>
        async function runSimulation() {
            const output = document.getElementById("output");
            output.innerHTML = "⏳ Pyodide yükleniyor... (İlk seferde 15-30 saniye sürebilir)";
            
            // Pyodide'i yükle
            let pyodide = await loadPyodide();
            await pyodide.loadPackage(["matplotlib", "numpy"]);
            
            output.innerHTML = "🔍 Simülasyon çalıştırılıyor...";
            
            // Python kodu
            try {
                await pyodide.runPython(`
                import matplotlib.pyplot as plt
                import numpy as np
                import io, base64
                
                # Vitray ışık dağılım simülasyonu
                x = np.linspace(0, 10, 100)
                y = np.sin(x) * np.cos(x**2)  # Örnek desen
                
                plt.figure(figsize=(8, 4))
                plt.plot(x, y, color='purple', linewidth=3)
                plt.title("Vitray Işık Deseni", fontsize=14)
                plt.xlabel("Pencere Alanı")
                plt.ylabel("Işık Şiddeti")
                plt.grid(True)
                
                # Grafiği HTML'e aktarma
                buf = io.BytesIO()
                plt.savefig(buf, format='png')
                buf.seek(0)
                image_base64 = base64.b64encode(buf.read()).decode('utf-8')
                plt.close()
                js_image = f"data:image/png;base64,{image_base64}"
                js.document.getElementById("plot").src = js_image
                `);
                
                document.getElementById("plot").style.display = "block";
                output.innerHTML = "✅ Simülasyon başarılı! Sonuçlar:";
            } catch (error) {
                output.innerHTML = `❌ Hata: ${error}`;
            }
        }
    </script>
</body>
</html>
