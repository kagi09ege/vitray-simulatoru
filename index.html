<!DOCTYPE html>
<html>
<head>
    <title>Bit Vitray Işık Simülatörü</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #222;
            color: white;
            margin: 0;
            padding: 20px;
        }
        #container {
            max-width: 600px;
            margin: 0 auto;
            background: #333;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        #bit-vitray {
            width: 100%;
            height: 400px;
            background: black;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }
        .pixel {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 3px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.7);
        }
        .light {
            position: absolute;
            width: 100px;
            height: 30px;
            background: yellow;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.7;
            border-radius: 5px 5px 0 0;
            cursor: move;
        }
        .controls {
            margin: 15px 0;
        }
        button {
            background: #6a3093;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
        }
        #color-output {
            height: 50px;
            margin: 15px auto;
            border-radius: 5px;
            background: #111;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>Bit Vitray Işık Simülatörü</h1>
        <p>Işık kaynağını sürükleyin, vitray ışığı renklerine ayırsın!</p>
        
        <div id="bit-vitray">
            <div class="light" id="light-source"></div>
            <!-- Pikseller buraya eklenecek -->
        </div>
        
        <div class="controls">
            <button id="generate-btn">Yeni Vitray Oluştur</button>
            <div>
                <label>Işık Gücü: <span id="power-value">50</span>%</label>
                <input type="range" id="light-power" min="10" max="100" value="50">
            </div>
        </div>
        
        <div id="color-output">
            Filtrelenmiş Işık Rengi: <span id="rgb-code">RGB(0,0,0)</span>
        </div>
    </div>

    <script>
        // Temel ayarlar
        const vitray = document.getElementById('bit-vitray');
        const light = document.getElementById('light-source');
        const rgbCode = document.getElementById('rgb-code');
        const powerValue = document.getElementById('power-value');
        
        // Vitray oluşturma
        function createVitray() {
            vitray.innerHTML = '';
            vitray.appendChild(light);
            
            const width = Math.floor(vitray.offsetWidth / 20);
            const height = Math.floor(vitray.offsetHeight / 20) - 2;
            
            const colors = [
                'rgba(255,0,0,0.7)', 'rgba(0,255,0,0.7)', 'rgba(0,0,255,0.7)',
                'rgba(255,255,0,0.7)', 'rgba(255,0,255,0.7)', 'rgba(0,255,255,0.7)'
            ];
            
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const pixel = document.createElement('div');
                    pixel.className = 'pixel';
                    pixel.style.left = `${x * 20}px`;
                    pixel.style.top = `${y * 20}px`;
                    pixel.style.background = colors[Math.floor(Math.random() * colors.length)];
                    vitray.appendChild(pixel);
                }
            }
            
            updateLightEffect();
        }
        
        // Işık etkisini güncelle
        function updateLightEffect() {
            const lightRect = light.getBoundingClientRect();
            const power = document.getElementById('light-power').value / 100;
            powerValue.textContent = document.getElementById('light-power').value;
            
            let totalR = 0, totalG = 0, totalB = 0;
            let count = 0;
            
            document.querySelectorAll('.pixel').forEach(pixel => {
                const pixelRect = pixel.getBoundingClientRect();
                const dx = Math.abs((lightRect.left + lightRect.width/2) - (pixelRect.left + pixelRect.width/2));
                const dy = (pixelRect.top + pixelRect.height/2) - (lightRect.top + lightRect.height/2);
                
                if (dy > 0) {
                    const effect = power * (1 - dx/200) * parseFloat(pixel.style.background.split(',')[3]);
                    
                    if (effect > 0.1) {
                        const color = pixel.style.background.match(/\d+/g);
                        totalR += color[0] * effect;
                        totalG += color[1] * effect;
                        totalB += color[2] * effect;
                        count++;
                    }
                }
            });
            
            if (count > 0) {
                const r = Math.round(totalR / count);
                const g = Math.round(totalG / count);
                const b = Math.round(totalB / count);
                rgbCode.textContent = `RGB(${r},${g},${b})`;
                document.getElementById('color-output').style.background = `rgb(${r},${g},${b})`;
            }
        }
        
        // Işık kaynağını sürükleme
        light.addEventListener('mousedown', function(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startLeft = parseFloat(light.style.left) || 0;
            
            function moveLight(e) {
                const newLeft = startLeft + e.clientX - startX;
                const maxLeft = vitray.offsetWidth - light.offsetWidth;
                light.style.left = `${Math.max(0, Math.min(maxLeft, newLeft))}px`;
                updateLightEffect();
            }
            
            function stopDrag() {
                document.removeEventListener('mousemove', moveLight);
                document.removeEventListener('mouseup', stopDrag);
            }
            
            document.addEventListener('mousemove', moveLight);
            document.addEventListener('mouseup', stopDrag);
        });
        
        // Kontroller
        document.getElementById('generate-btn').addEventListener('click', createVitray);
        document.getElementById('light-power').addEventListener('input', updateLightEffect);
        
        // Başlangıçta vitray oluştur
        createVitray();
    </script>
</body>
</html>
